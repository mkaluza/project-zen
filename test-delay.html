<html>
<head>
<style>
BODY {
	font-size:16px;
	font-family: sans-serif;
}
#container {
	width: 400px;
}

#marker {
	width: 99%;
	margin: 5px 0px;
	padding: 35px 0px;
	border: 1px solid black;
	text-align: center;
	font-size: 36px;
}
button {
	min-height:20px;
}

#controls > button {
	min-width: 100px;
	width: 30%;
	font-size: 36px;
	padding: 10px
}

#controls {
	text-align: center;
	margin: 20px 0px;
}

#output,#sstatus {
	font-size: 16px;
}

</style>
</head>
<BODY>
	<div id=container>
		<div id=manual>
			Tap the box as if it was some action you wanted to do (i.e. open a text message), then rate the delay as:
			<ul>
				<li> 1 - ok
				<li> 0 - a bit annoying, but acceptable from time to time
				<li> -1 - unacceptably long
			</ul>
			<br>
			<button onclick="manual.style.display='none';contents.style.display='block';"> Ok, I get it </button>
		</div>
	<div id=contents style="display:none">
	<div id=marker onclick="timeIt();">Tap me :)</div>
	<div id=controls>
		<button onclick="rate(-1);">-1</button>
		<button onclick="rate(0);">0</button>
		<button onclick="rate(1);">1</button>
	</div>
	<div id=sstatus>
	</div>
	<hr>
	<div id=output>
	</div>
	</div>
</div>
	<script type="text/javascript">
		var timeout, tmax=1000, tmin=0;
		var results=[[],[],[]];
		var contents=document.getElementById("contents");
		var manual=document.getElementById("manual");
		var sstatus=document.getElementById("sstatus");
		var output=document.getElementById("output");
		var controls=document.getElementById("controls");
		var marker=document.getElementById("marker");
		var tstart, dt;
		function disableControls(state) {
			var buttons=controls.getElementsByTagName("BUTTON");
			for(var i=0; i<buttons.length; i++)
				buttons[i].disabled=state;

		}
		function timeIt() {
			marker.onclick=undefined;
			marker.style.backgroundColor="#FF0";
			timeout=Math.round(Math.random()*(tmax-tmin)+tmin);
			setTimeout(onTimer, timeout);
			tstart=new Date();
			
		}
		function onTimer() {
			dt=(new Date()).getTime()-tstart.getTime();
			marker.style.backgroundColor="#0F0";
			disableControls(false);
		}
		function rate(value) {
			disableControls(true);
			marker.onclick=timeIt;
			marker.style.backgroundColor="white";
			switch (value) {
				case -1:
					tmax -= Math.round((tmax-timeout)*.05);
					break;
				case 1: 
					tmin += Math.round((timeout-tmin)*.05);
					break;
			}
			var res = results[1-value];
			res.push(dt);
			res.sort(function(a, b){return a-b});
			sstatus.innerHTML="tmin: "+tmin+", tmax: "+tmax;
			for(i in results) 
				sstatus.innerHTML+="<br>"+results[i].join(", ");
			//output.innerHTML=dt+"("+timeout+")"+": "+value+"</br>"+output.innerHTML;
			output.innerHTML=dt+": "+value+"</br>"+output.innerHTML;
		}
		disableControls(true);
	</script>
</BODY>
